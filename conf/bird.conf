/* itforprof.com by Konstantin Tyutyunnik */

log syslog all;

/* Set your router ID (one of the loopback IPs or any stable IP) */
router id ${ROUTER_ID};

/* Dedicated table for exported prefixes */
ipv4 table t_bgp_prefixes;

protocol device {
    scan time 10;
}

/* Load generated prefixes */
protocol static bgp_prefixes {
    ipv4 { table t_bgp_prefixes; };
    include "/etc/bird/prefixes.bird";
}

/* Template for BGP clients */
template bgp t_client {
    local as ${LOCAL_AS};
    multihop;
    # password "md5secret"; # Optional: MD5 password for authentication
    ipv4 {
        import none; /* We do not accept routes from clients */
        export filter {
            if proto = "bgp_prefixes" then accept;
            reject;
        };
        export limit 20000 action disable; /* Safety limit */
    };
}

/* Example client */

/* Standard static neighbor */
/*
protocol bgp client1 from t_client {
    neighbor 192.0.2.1 as 65001;
}
*/

/* Dynamic neighbors (accepts any connection from the range) */
/* NOTE: BIRD v2 does not support MD5 passwords for dynamic ranges */
/*
protocol bgp any_client from t_client {
    neighbor range 0.0.0.0/0 as 64999;
}
*/

